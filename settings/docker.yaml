- name: ckanext-coatcustom
  repository: https://$GITLAB_USERNAME:$GITLAB_PASSWORD@gitlab.com/nina-data/ckanext-coatcustom.git
  version: master
  settings_add:
    - ["app:main", ckan.plugins, coatcustom]
  targets:
    - deploy
- name: ckanext-coatcustom
  repository: https://gitlab-ci-token:$CI_JOB_TOKEN@gitlab.com/nina-data/ckanext-coatcustom.git
  version: master
  settings_add:
    - ["app:main", ckan.plugins, coatcustom]
  targets:
    - deploy-gitlab
- name: ckanext-coatcustom
  local: true
  repository: ckanext-coatcustom
  settings_add:
    - ["app:main", ckan.plugins, coatcustom]
  targets:
    - dev
- name: ckanext-scheming
  repository: https://github.com/ckan/ckanext-scheming
  version: master
  settings_add:
    - ["app:main", ckan.plugins, scheming_datasets]
    - ["app:main", ckan.plugins, scheming_organizations]
  settings_set:
    - ["app:main", scheming.dataset_schemas, "ckanext.coatcustom:coat_schema.json"]
    - ["app:main", scheming.organization_schemas, "ckanext.coatcustom:coat_org_schema.json"]
    - ["app:main", scheming.presets, "ckanext.coatcustom:coat_presets.json"]
    - ["app:main", scheming.dataset_fallback, false]
  targets:
    - dev
    - deploy
    - deploy-gitlab
- name: ckanext-spatial
  repository: https://github.com/frafra/ckanext-spatial
  version: staging
  settings_add:
    - ["app:main", ckan.plugins, spatial_metadata spatial_query]
  settings_set:
    - ["app:main", ckanext.spatial.search_backend, solr]
  targets:
    - dev
    - deploy
    - deploy-gitlab
- name: ckanext-dcat
#  repository: https://github.com/ckan/ckanext-dcat
#  version: master
  repository: https://github.com/frafra/ckanext-dcat
  version: next
  settings_add:
    - ["app:main", ckan.plugins, dcat structured_data]
  targets:
    - dev
    - deploy
    - deploy-gitlab
#- name: ckanext-geoview
#  repository: https://github.com/ckan/ckanext-geoview
#  version: v0.0.13
#  settings_add:
#    - ["app:main", ckan.plugins, resource_proxy geojson_view]
#  settings_set:
#    - ["app:main", ckan.views.default_views, geojson_view]
#  targets:
#    - dev
#    - deploy
- name: ckanext-oauth2
  repository: https://github.com/NINAnor/ckanext-oauth2
  version: feide
  settings_add:
    - ["app:main", ckan.plugins, oauth2]
  settings_set:
#    - ["app:main", ckan.oauth2.register_url, https://YOUR_OAUTH_SERVICE/users/sign_up]
#    - ["app:main", ckan.oauth2.reset_url, https://YOUR_OAUTH_SERVICE/users/password/new]
#    - ["app:main", ckan.oauth2.edit_url, https://YOUR_OAUTH_SERVICE/settings]
    - ["app:main", ckan.oauth2.profile_api_url, "https://auth.dataporten.no/userinfo"]
    - ["app:main", ckan.oauth2.scope, profile email]
#    - ["app:main", ckan.oauth2.rememberer_name, auth_tkt]
    - ["app:main", ckan.oauth2.profile_api_user_field, email]
    - ["app:main", ckan.oauth2.profile_api_fullname_field, name]
    - ["app:main", ckan.oauth2.profile_api_mail_field, email]
#    - ["app:main", ckan.oauth2.authorization_header, OAUTH2_HEADER]
  targets:
    - deploy
    - deploy-gitlab
- name: ckanext-datasetversions
  repository: https://github.com/frafra/ckanext-datasetversions.git
  version: staging
  settings_add:
    - ["app:main", ckan.plugins, datasetversions]
  targets:
    - deploy
    - deploy-gitlab
- name: ckanext-datasetversions
  repository: ckanext-datasetversions
  local: true
  settings_add:
    - ["app:main", ckan.plugins, datasetversions]
  targets:
    - dev
- name: ckanext-coat
  repository: https://$GITLAB_USERNAME:$GITLAB_PASSWORD@gitlab.com/nina-data/ckanext-coat.git
  version: master
  settings_add:
    - ["app:main", ckan.plugins, coat]
    - ["app:main", ckanext.coat.resource_name_globally_unique, true]
  settings_set:
    - ["app:main", ckanext.coat.custom_form, false]
  targets:
    - deploy
- name: ckanext-coat
  repository: https://gitlab-ci-token:$CI_JOB_TOKEN@gitlab.com/nina-data/ckanext-coat.git
  version: master
  settings_add:
    - ["app:main", ckan.plugins, coat]
    - ["app:main", ckanext.coat.resource_name_globally_unique, true]
  settings_set:
    - ["app:main", ckanext.coat.custom_form, false]
  targets:
    - deploy-gitlab
- name: ckanext-coat
  local: true
  repository: ckanext-coat
  settings_add:
    - ["app:main", ckan.plugins, coat]
    - ["app:main", ckanext.coat.resource_name_globally_unique, true]
  settings_set:
    - ["app:main", ckanext.coat.custom_form, false]
  targets:
    - dev
- name: config
  settings_set:
    - ["app:main", ckan.site_title, "COAT Data Portal"]
    - ["app:main", ckan.site_intro_text, "Climate-ecological Observatory for Arctic Tundra (COAT)"]
    - ["app:main", ckan.site_logo, "images/coat.png"]
    - ["app:main", ckan.datastore.sqlalchemy.pool_pre_ping, true]
    - ["app:main", ckan.favicon, "images/coat.png"]
    - ["app:main", ckan.locale_default, en]
  settings_add:
    - ["app:main", ckan.locale_offered, en]
  targets:
    - dev
    - deploy
    - deploy-gitlab
- name: config-dev
  settings_set:
    - [DEFAULT, debug, true]
  targets:
    - dev
