- name: ckanext-spatial
  repository: https://github.com/ckan/ckanext-spatial
  version: master
  settings_add:
    - ["app:main", ckan.plugins, spatial_metadata spatial_query]
  settings_set:
    - ["app:main", ckanext.spatial.search_backend, solr]
  targets:
    - dev
    - deploy
#- name: ckanext-geoview
#  repository: https://github.com/ckan/ckanext-geoview
#  version: v0.0.13
#  settings_add:
#    - ["app:main", ckan.plugins, resource_proxy geojson_view]
#  settings_set:
#    - ["app:main", ckan.views.default_views, geojson_view]
#  targets:
#    - dev
#    - deploy
- name: ckanext-ldap
  repository: https://github.com/NaturalHistoryMuseum/ckanext-ldap.git
  version: ckan-upgrade-2.8.0a
  packages:
    - libsasl2-dev
    - python-dev
    - libldap2-dev
    - libssl-dev
  settings_add:
    - ["app:main", ckan.plugins, ldap]
  settings_set:
    - ["app:main", ckanext.ldap.uri, "ldap://nindc05.nina.no:389"]
    - ["app:main", ckanext.ldap.auth.dn, ldapquery]
    - ["app:main", ckanext.ldap.base_dn, "ou=brukere,dc=nina,dc=no"]
    - ["app:main", ckanext.ldap.search.filter, "sAMAccountName={login}"]
    - ["app:main", ckanext.ldap.username, sAMAccountName]
    - ["app:main", ckanext.ldap.email, mail]
    - ["app:main", ckanext.ldap.ckan_fallback, true]
  settings_set_startup:
    - ["app:main", ckanext.ldap.auth.password, LDAP_PASSWORD]
  targets:
    - dev
    - deploy
- name: ckanext-datasetversions
  repository: https://github.com/frafra/ckanext-datasetversions.git
  version: flask-migration
  settings_add:
    - ["app:main", ckan.plugins, datasetversions]
  targets:
    - dev
    - deploy
- name: ckanext-coat
  repository: https://gitlab-ci-token:$CI_JOB_TOKEN@gitlab.com/nina-data/ckanext-coat.git
  version: master
  settings_add:
    - ["app:main", ckan.plugins, coat]
  targets:
    - deploy
- name: ckanext-coat
  local: true
  repository: ckanext-coat
  settings_add:
    - ["app:main", ckan.plugins, coat]
  targets:
    - dev
- name: config
  settings_set:
    - ["app:main", ckan.site_title, "COAT catalog"]
    - ["app:main", ckan.site_intro_text, "# Welcome to the COAT catalog"]
    - ["app:main", ckan.site_logo, "https://www.coat.no/Portals/coat/Images/cropped-coat_logo_black2014_tr.png"]
  targets:
    - dev
    - deploy
- name: config-dev
  settings_set:
    - [DEFAULT, debug, true]
  targets:
    - dev
