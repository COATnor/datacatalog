- name: ckanext-coatcustom
  settings_add:
    - ["app:main", ckan.plugins, coatcustom]
    - ["app:main", ckan.rdf.profiles, "nina_dcat_profile=ckanext.coatcustom.nina_dcat_profile:CoatDcatProfile"]
  targets:
    - dev
    - deploy
- name: ckanext-scheming
  settings_add:
    - ["app:main", ckan.plugins, scheming_datasets]
    - ["app:main", ckan.plugins, scheming_organizations]
  settings_set:
    - ["app:main", scheming.dataset_schemas, "ckanext.coatcustom:coat_schema.json ckanext.coatcustom:coat_statevariable_schema.json ckanext.coatcustom:coat_protocol_schema.json"]
    - ["app:main", scheming.organization_schemas, "ckanext.coatcustom:coat_org_schema.json"]
    - ["app:main", scheming.presets, "ckanext.coatcustom:coat_presets.json"]
    - ["app:main", scheming.dataset_fallback, false]
  targets:
    - dev
    - deploy
- name: ckanext-spatial
  settings_add:
    - ["app:main", ckan.plugins, spatial_metadata spatial_query]
  settings_set:
    - ["app:main", ckanext.spatial.search_backend, solr]
  targets:
    - dev
    - deploy
- name: ckanext-dcat
  settings_add:
    - ["app:main", ckan.plugins, dcat structured_data]
  targets:
    - dev
    - deploy
- name: ckanext-harvest
  settings_add:
    - ["app:main", ckan.plugins, harvest ckan_harvester]
  targets:
    - dev
    - deploy
- name: ckanext-kata
  targets:
    - dev
    - deploy
- name: ckanext-oaipmh
  settings_add:
    - ["app:main", ckan.plugins, oaipmh]
  packages:
    - python-dev
    - libldap2-dev
    - libsasl2-dev
    - libssl-dev
  targets:
    - dev
    - deploy
- name: ckanext-doi
  settings_add:
    - ["app:main", ckan.plugins, doi]
  settings_set:
    - ["app:main", ckanext.doi.test_mode, True]
    - ["app:main", ckanext.doi.publisher, "NINA"]
    - ["app:main", ckanext.doi.site_url, "http://coatdemo.nina.no"]
    - ["app:main", ckanext.doi.site_title, "coatdemo"]
  settings_set_startup:
    - ["app:main", ckanext.doi.prefix, DOI_ACCOUNT_PREFIX_TEST]
    - ["app:main", ckanext.doi.account_name, DOI_ACCOUNT_NAME_TEST]
    - ["app:main", ckanext.doi.account_password, DOI_ACCOUNT_PWD_TEST]
  targets:
    - dev
- name: ckanext-doi
  settings_add:
    - ["app:main", ckan.plugins, doi]
  settings_set:
  - ["app:main", ckanext.doi.test_mode, False]
    - ["app:main", ckanext.doi.publisher, "NINA"]
    - ["app:main", ckanext.doi.site_url, "http://data.coat.no"]
    - ["app:main", ckanext.doi.site_title, "coat data portal"]
  settings_set_startup:
    - ["app:main", ckanext.doi.prefix, DOI_ACCOUNT_PREFIX_DEPLOY]
    - ["app:main", ckanext.doi.account_name, DOI_ACCOUNT_NAME_DEPLOY]
    - ["app:main", ckanext.doi.account_password, DOI_ACCOUNT_PWD_DEPLOY]
  targets:
    - deploy
#- name: ckanext-geoview
#  repository: https://github.com/ckan/ckanext-geoview
#  version: v0.0.13
#  settings_add:
#    - ["app:main", ckan.plugins, resource_proxy geojson_view]
#  settings_set:
#    - ["app:main", ckan.views.default_views, geojson_view]
#  targets:
#    - dev
#    - deploy
- name: ckanext-oauth2
  settings_add:
    - ["app:main", ckan.plugins, oauth2]
  settings_set:
#    - ["app:main", ckan.oauth2.register_url, https://YOUR_OAUTH_SERVICE/users/sign_up]
#    - ["app:main", ckan.oauth2.reset_url, https://YOUR_OAUTH_SERVICE/users/password/new]
#    - ["app:main", ckan.oauth2.edit_url, https://YOUR_OAUTH_SERVICE/settings]
    - ["app:main", ckan.oauth2.profile_api_url, "https://auth.dataporten.no/userinfo"]
    - ["app:main", ckan.oauth2.scope, profile email]
#    - ["app:main", ckan.oauth2.rememberer_name, auth_tkt]
    - ["app:main", ckan.oauth2.profile_api_user_field, email]
    - ["app:main", ckan.oauth2.profile_api_fullname_field, name]
    - ["app:main", ckan.oauth2.profile_api_mail_field, email]
#    - ["app:main", ckan.oauth2.authorization_header, OAUTH2_HEADER]
  targets:
    - deploy
- name: ckanext-datasetversions
  settings_add:
    - ["app:main", ckan.plugins, datasetversions]
  targets:
    - dev
    - deploy
- name: ckanext-coat
  settings_add:
    - ["app:main", ckan.plugins, coat]
    - ["app:main", ckanext.coat.resource_name_globally_unique, true]
  settings_set:
    - ["app:main", ckanext.coat.custom_form, false]
  targets:
    - dev
    - deploy
- name: config
  dummy: true
  settings_set:
    - ["app:main", ckan.site_title, "COAT Data Portal"]
    - ["app:main", ckan.site_intro_text, "Climate-ecological Observatory for Arctic Tundra (COAT)"]
    - ["app:main", ckan.site_logo, "images/coat.png"]
    - ["app:main", ckan.datastore.sqlalchemy.pool_pre_ping, true]
    - ["app:main", ckan.favicon, "images/coat.png"]
    - ["app:main", ckan.locale_default, en_ZW]
  settings_add:
    - ["app:main", ckan.locale_offered, en_ZW]
  targets:
    - dev
    - deploy
- name: config-dev
  dummy: true
  settings_set:
    - [DEFAULT, debug, true]
  targets:
    - dev
